{% load static %}
<title> Profile </title>
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>

<body>

  <div class="profile-container">
    <a href="{% url 'home' %}" class="close-link">
      <i class='bx bx-x ac-close'></i>
    </a>
    <div class="profile-sticky">
      <!-- âœ… USER INFO ROW (Updated Layout) -->
      <div class="user-row">

        <!-- âœ… PROFILE IMAGE WITH CAMERA & DEFAULT ICON -->
        <div class="profile-pic-wrapper">

          {% if profile.image %}
          <img src="{{ profile.image }}" class="profile-img">
          {% else %}
          <i class="bx bxs-user default-user-icon"></i>
          <img src="{% static 'images/default-user.png' %}" class="profile-img">
          {% endif %}
        </div>


        <!-- âœ… USERNAME + NAME + SETTINGS ICON -->
        <div class="user-right">

          <div class="user-top-row">
            <div class="user-text">
              {% for login in userlogin %}
              <h2 class="username">{{ login.username }}</h2>
              <span class="full-name">{{ login.name }}</span>
              {% endfor %}
            </div>

          </div>

          <!-- âœ… COUNTS ROW (UNCHANGED) -->
          <div class="counts">
            <div>
              <b>{{ post_count }}</b>
              <span>Posts</span>
            </div>
            <div>
              <b>{{ followers_count}}</b>
              <span>Followers</span>
            </div>
            <div>
              <b>{{ following_count }}</b>
              <span>Following</span>
            </div>
          </div>

          <div class="bio">
            <p class="bio-text">
              {{ profile.bio|default:"No bio added yet." }}
            </p>
          </div>


        </div>
      </div>

      <!-- âœ… EDIT BUTTON ROW (UNCHANGED) -->
      <div class="edit-btn-container">
        <a href="{% url 'setting' %}">
          <button class="edit-btn">Edit Profile</button>
        </a>
      </div>

      <!-- âœ… TABS -->
      <div class="tabs">
        <div class="tab active" data-tab="posts">
          <i class="bx bx-grid-alt"></i>
          <span>Posts</span>
        </div>

        <div class="tab" data-tab="reels">
          <i class="bx bx-play-circle"></i>
          <span>Reels</span>
        </div>

        <div class="tab" data-tab="saved">
          <i class="bx bx-bookmark"></i>
          <span>Saved</span>
        </div>
      </div>


      <!-- âœ… POSTS TAB CONTENT (IMPORTANT FIX âœ…) -->
      <div class="tab-content active" id="posts">
        

        <h2>All Posts</h2>
        <div class="posts-grid">
          {% for p in posts %}
          <div class="post-item">
            {% if p.1 %}
            {% if p.1|lower|slice:"-4:" == ".mp4" %}
            <video controls>
              <source src="{{ p.1 }}" class="grid-post" type="video/mp4" />
              Your browser does not support the video tag.
            </video>
            {% else %}
            <img src="{{ p.1 }}" class="grid-post" alt="post image" onclick="openViewPost('{{ p.1 }}')" />
            {% endif %}
            {% endif %}
          </div>

          {% empty %}
          <p>No posts available.</p>
          {% endfor %}
        </div>
      </div>
    </div>
   


    



    <!-- âœ… REELS TAB CONTENT -->
    <div class="tab-content" id="reels">
      <h3 class="gs-title">Reels</h3>
      <p>This is your Reels section.</p>
    </div>


    <!-- âœ… SAVED TAB CONTENT -->
    <div class="tab-content" id="saved">
      <h3 class="gs-title">Saved</h3>
      <p>This is your Saved posts section.</p>
    </div>
    



  <!-- VIEW POST POPUP (NEW) -->
  <div class="view-post-overlay" id="viewPostPopup">

    <div class="view-post-box">

      <!-- LEFT IMAGE -->
      <div class="view-post-left">
        <img id="viewPostImage" src=>
        <a href="{% url 'home' %}" class="close-link">
      
    </a>
      </div>

      <!-- RIGHT CONTENT -->
      <div class="view-post-right">
       

          <!-- HEADER -->
          <div class="view-post-header">
            <!-- 3 DOT MENU -->
              <div class="post-menu">
                <i class="bx bx-dots-horizontal-rounded" onclick="togglePostMenu()"></i>

                <div class="post-menu-dropdown" id="postMenu">
                  <a href="#"  onclick="openEditPost(document.getElementById('viewPostImage').src)">Edit</a>
                  <a href="#">Delete</a>
                  <a href="#" onclick="togglePostMenu()">Cancel</a>
                </div>
              </div>
            <div class="view-user">
                {% if profile.image %}
                   <img src="{{ profile.image }}" class="view-user-pic">
                {% else %}
                  <i class="bx bxs-user default-user-icon"></i>
                  <img src="{% static 'images/default-user.png' %}" class="view-user-pic">
                {% endif %}
               {% for login in userlogin %} 
              <span>{{ login.username }}</span>
              {% endfor %}
            </div>

            
                        
          </div>

          <!-- COMMENTS -->
          <div class="view-comments">
            <p><b>hjhjh</b> Caption here</p>
            <p><b>user1</b> Nice ðŸ”¥</p>
          </div>

          <!-- ACTIONS -->
          <div class="view-actions">
            <div>
              <a>
              <i class="bx bx-heart"></i>
              </a>
            </div>
            <i class="bx bx-bookmark"></i>
          </div>
          {% for post in posts %}
       <form method="post" action="{% url 'add_comment' post.0 %}">
         {% endfor %}
          {% csrf_token %}
          <!-- ADD COMMENT -->
          <div class="view-add-comment">
            <textarea type="text" name="cmt" placeholder="Add a comment..." required></textarea>
            <input type="submit" value="Post">
          </div>

        </form>
       
      </div>

    </div>
          
          <!--editpost-->
          
          <!--End-->
  </div>




  <!-- EDIT POST POPUP -->
<div class="edit-post-overlay" id="editPostPopup">

  <div class="edit-post-box">

    <div class="edit-post-header">
      <span onclick="closeEditPost()" class="edit-cancel">Cancel</span>
      <h3>Edit info</h3>
      <span class="edit-done">Done</span>
    </div>

    <div class="edit-post-body">
      <div class="edit-left">
        <img id="editPostImage" src="">
      </div>

      <div class="edit-right">
        <div class="edit-user">
          <img src="{{ profile.image|default:'static/images/default-user.png' }}">
          {% for login in userlogin %}
            <span>{{ login.username }}</span>
          {% endfor %}
        </div>

        <textarea placeholder="Edit caption..."></textarea>

        <div class="edit-options">
          <p>Add location</p>
          <p>Accessibility</p>
        </div>
      </div>
    </div>

  </div>
</div>


</body>
<script src="{% static 'js/profile.js' %}"></script>

</html>
