{% load static %}
<title> Profile </title>
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>
<body>

  <div class="profile-container">
    <a href="{% url 'home' %}" class="close-link">
      <i class='bx bx-x ac-close'></i>
    </a>
    <div class="profile-sticky">
      <!-- âœ… USER INFO ROW (Updated Layout) -->
      <div class="user-row">

       
        <!-- âœ… PROFILE IMAGE WITH CAMERA & DEFAULT ICON -->
        <div class="profile-pic-wrapper">

          {% if profile.image %}
          <img src="{{ profile.image }}" class="profile-img">
          {% else %}
          <i class="bx bxs-user default-user-icon"></i>
          <img src="{% static 'images/default-user.png' %}" class="profile-img">
          {% endif %}

        
        </div>

        <!-- âœ… USERNAME + NAME + SETTINGS ICON -->
        <div class="user-right">

          <div class="user-top-row">
            <div class="user-text">
              {% for login in userlogin %}
              <h2 class="username">{{ login.username }}</h2>
              <span class="full-name">{{ login.name }}</span>
              {% endfor %}
            </div>

          </div>

          <!-- âœ… COUNTS ROW (UNCHANGED) -->
          <div class="counts">
            <div>
              <b>{{ post_count }}</b>
              <span>Posts</span>
            </div>
            <div>
              <b>{{ followers_count }}</b>
              <span>Followers</span>
            </div>
            <div>
              <b>{{ following_count }}</b>
              <span>Following</span>
            </div>
          </div>

           <div class="bio">
          <p class="bio-text">
            {{ profile.bio|default:"No bio added yet." }}
          </p>
        </div>
          

        </div>
      </div>

      <!-- âœ… EDIT BUTTON ROW (UNCHANGED) -->
      <div class="edit-btn-container">
        <a href="{% url 'setting' %}">
          <button class="edit-btn">Edit Profile</button>
        </a>
      </div>

      <!-- âœ… TABS -->
      <div class="tabs">
        <div class="tab active" data-tab="posts">
          <i class="bx bx-grid-alt"></i>
          <span>Posts</span>
        </div>

        <div class="tab" data-tab="reels">
          <i class="bx bx-play-circle"></i>
          <span>Reels</span>
        </div>

        <div class="tab" data-tab="saved">
          <i class="bx bx-bookmark"></i>
          <span>Saved</span>
        </div>
      </div>


      <!-- âœ… POSTS TAB CONTENT (IMPORTANT FIX âœ…) -->
      <div class="tab-content active" id="posts">

        <h2>All Posts</h2>
        <div class="posts-grid">
          {% for p in posts %}
          <div class="post-item">
            {% if p.1 %}
            {% if p.1|lower|slice:"-4:" == ".mp4" %}
            <video controls>
              <source src="{{ p.1 }}"  class="grid-post"  type="video/mp4" />
              Your browser does not support the video tag.
            </video>
            {% else %}
            <img src="{{ p.1 }}"  class="grid-post"  alt="post image" onclick="openPostView('{{ p.1 }}')" />
            {% endif %}
            {% endif %}
          </div>

          {% empty %}
          <p>No posts available.</p>
          {% endfor %}
        </div>
      </div>
        


   


    </div>

    <!-------------------------------------------------------------------------------------------------->
    <!-- POST VIEW MODAL -->
<div class="post-view-overlay" id="postViewModal">
  <div class="post-view-box">

    <!-- LEFT IMAGE -->
    <div class="post-view-left">
      <img id="postViewImage" src="">
    </div>


  </div>
</div>



    <!-- âœ… REELS TAB CONTENT -->
    <div class="tab-content" id="reels">
      <h3 class="gs-title">Reels</h3>
      <p>This is your Reels section.</p>
    </div>


    <!-- âœ… SAVED TAB CONTENT -->
    <div class="tab-content" id="saved">
      <h3 class="gs-title">Saved</h3>
      <p>This is your Saved posts section.</p>
    </div>












    <!--popuo------------------------------------------>
    <!-- âœ… CREATE POST MODAL -->
    <div class="create-post-overlay" id="createPostModal">

      <div class="create-post-box">

        <!-- HEADER -->
        <div class="create-post-header">
          <span>Create new post</span>
          <i class="bx bx-x" id="closePostModal"></i>
        </div>

        <!-- BODY -->
        <div class="create-post-body">
          <i class="bx bx-images post-big-icon"></i>
          <p>Drag photos and videos here</p>

          <button class="select-btn" id="selectFromComputer">
            Select from computer
          </button>

          <input type="file" id="postFileInput" hidden accept="image/*,video/*">
        </div>

      </div>
    </div>


    <!-------------------------------------------------------------secomd popup-->

    <!-- âœ… CROP MODAL -->
    <div class="crop-overlay" id="cropModal">
      <div class="crop-box">
        <i class="bx bx-x close-crop" id="closeCrop"></i>

        <!-- âœ… HEADER -->
        <div class="crop-header">
          <i class="bx bx-arrow-back crop-back" id="backToUpload"></i>
          <button class="share-btn" id="sharepost">Share</button>
        </div>

        <div class="crop-body">
          <!-- âœ… IMAGE PREVIEW -->
          <div class="crop-left">
            <img id="cropImage" src="">
          </div>

          <!-- RIGHT SIDE: USER + CAPTION -->
          <div class="crop-right">

            <div class="user-info">
              <img src="user.jpg" class="user-pic">
              <span class="username">your_username</span>
            </div>
            <textarea class="caption-box" placeholder="Write a caption..."></textarea>
          </div>
        </div>
      </div>
    </div>

    <!--3rd popup------------------------------------------------------->
    <!-- âœ… DISCARD CONFIRM MODAL -->
    <div class="discard-overlay" id="discardModal">

      <div class="discard-box">
        <h3>Discard post?</h3>
        <p>If you leave, your edits won't be saved.</p>

        <div class="discard-actions">
          <button class="discard-btn" id="confirmDiscard">Discard</button>
          <button class="cancel-btn" id="cancelDiscard">Cancel</button>
        </div>
      </div>
    </div>
  </div>





  <!-- VIEW POST POPUP (NEW) -->
<div class="view-post-overlay" id="viewPostPopup">

  <div class="view-post-box">

    <!-- LEFT IMAGE -->
    <div class="view-post-left">
      <img id="viewPostImage" src="">
    </div>

    <!-- RIGHT CONTENT -->
    <div class="view-post-right">
      <form method="post">
        {% csrf_token %}

        <!-- HEADER -->
        <div class="view-post-header">
          <div class="view-user">
            <img src="{{ request.user.profile.image.url }}" class="view-user-pic">
            <span>{{ request.user.username }}</span>
          </div>
          <i class="bx bx-dots-horizontal-rounded"></i>
        </div>

        <!-- COMMENTS -->
        <div class="view-comments">
          <p><b>{{ request.user.username }}</b> Caption here</p>
          <p><b>user1</b> Nice ðŸ”¥</p>
        </div>

        <!-- ACTIONS -->
        <div class="view-actions">
          <div>
            <i class="bx bx-heart"></i>
            <i class="bx bx-comment"></i>
          </div>
          <i class="bx bx-bookmark"></i>
        </div>

        <!-- ADD COMMENT -->
        <div class="view-add-comment">
          <input type="text" name="comment" placeholder="Add a comment...">
          <button type="submit">Post</button>
        </div>

      </form>
    </div>

  </div>
</div>

</body>
<script src="{% static 'js/profile.js' %}"></script>

</html>
