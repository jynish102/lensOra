{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Post</title>
    <link rel="stylesheet" href="{% static 'css/post_crud.css' %}">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>
<body>

    <!-- CLOSE ICON -->
    <a href="{% url 'profile' %}" class="close-btn">
        <i class="bx bx-x"></i>
    </a>

    <div class="top-card">
        <div class="top-card-content">

            <div class="user-row">
                <!-- PROFILE IMAGE -->
                <img src="{{ profile.image }}" class="top-user-img">

                <!-- USER TEXT -->
                <div class="user-text">
                    <h3 class="username">{{ username }}</h3>
                    <p class="info-text">
                        You can edit or delete your post here.
                        Select an image below to continue.
                    </p>
                </div>
            </div>
        </div>
    </div> 
    <div class="edit-post-container">
        <div class="image-grid">
            {% for post in posts %}
            <div class="image-item" data-post-id="{{ post.0 }}" 
                              data-caption="{{ post.3 |default:'' }}">
                <img src="{{ post.1 }}" alt="Post image">
                <span class="check-icon">âœ“</span>
            </div>
            {% endfor %}
           </div>
<div class="post-actions" id="postActions">
            <button class="edit-btn" disabled>Edit Post</button>
            <button class="delete-btn" disabled>Delete Post</button>
        </div>
    </div>

    <!-- EDIT POST MODAL -->
        <div class="edit-modal-overlay" id="editPostModal">
            <div class="edit-modal">

                <!-- HEADER -->
                <div class="edit-modal-header">
                    <button type="button" class="cancel-btn" onclick="closeEditModal()">Cancel</button>
                    <h3>Edit info</h3>
                    <button type="submit" form="editPostForm" class="done-btn">Done</button>
                </div>

                <!-- BODY -->
                
                <form method="post" action="{% url 'update_post' %}" id="editPostForm">
                    {% csrf_token %}
                    <input type="hidden" name="post_id" id="editPostId">
                    <div class="edit-modal-body">

                        <!-- LEFT -->
                        <div class="edit-image-box">
                            <img id="editPostImage">
                        </div>

                        <!-- RIGHT -->
                        <div class="edit-form-box">
                            <div class="edit-user-row">
                                <img src="{{ profile.image }}" class="edit-user-img">
                                <span class="edit-username">{{ username }}</span>
                            </div>
                               
                            <textarea name="caption"
                                    id="editCaption"
                                    placeholder="Write a caption..."
                                maxlength="2200"></textarea>
                            <div class="caption-counter">
    <span id="charCount">0</span> / 2200
</div>
                     </div>
                    </div>
                </form>
            </div>
        </div>
    <!-- DELETE MODAL -->
        <div class="delete-modal-overlay" id="deleteModal">
            <div class="delete-modal">
                <h3>Delete post?</h3>
                <p>This action cannot be undone.</p>
                <div class="delete-actions">
                    <a href="" id="deleteLink" class="delete-link">Delete</a>
                    <button type="button" class="cancel-delete" onclick="closeDeleteModal()" >Cancel</button>
                    </div>
                </div>
        </div>
</body>
<script src="{% static 'js/post_crud.js' %}"></script>
</html>

